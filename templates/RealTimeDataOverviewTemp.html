{# NON HARD-CODED VERSION #}
{% from '_formhelpers.html' import render_field %} {# import neede for chard range forms #}

{% extends 'layout.html' %} {# inherits format from layout.html #}

{% block title %} {# Overides layout.html default title #}
    <meta http-equiv="refresh" content="10" >

    <title>Current Data - {{ server.ServerName }}</title> {# Title - shown in tab on browser #}
    <link rel="icon" href="/static/favicons/health.ico">
{% endblock title %}

{% block content %}


    <a class="text-decoration-none" href="{{ url_for('home') }}">
        <div class="row mt-3 text-center"> {# Row for page header #}
            <div class="col-12 ml-auto p-3 mb-2 bg-secondary text-white">
                <h1>Server System Monitoring Tool</h1>
            </div>
        </div>
    </a>

    <div class="mt-3 text-center"> {# Home button & Rack & Server Names #}
        <div class="row card-body border border-dark font-weight-bold">
            <div class="text-left">
                <a class="btn btn-secondary btn-lg" href="{{ url_for('home') }}" role="button"><i
                        class="fa fa-home"></i> Home</a>
            </div>
            <div class="col-10">
                <h2 class="text-center">Rack: {{ rack.Name }} | Server: {{ server.ServerName }}</h2>
            </div>
        </div>
    </div>

    <div class="row mt-3 text-center"> {# Server Specs #}
        <div class="col-12 ">

            <table class="table table-bordered table-secondary">
                <th colspan="12">
                    Server Specifications
                </th>

                <tbody>
                <tr> {# Spec's names #}
                    <th>Operating System</th>
                    <th>CPU | Cores</th>
                    <th>GPU</th>
                    <th>Memory</th>
                    <th>Model</th>
                    <th>Building</th>
                    <th>Room</th>
                    <th>Last Updated</th>
                </tr>
                <tr> {# Spec's Values #}
                    <td>{{ server.Os }}</td>
                    <td>{{ server.Cpu }} | {{ server.CpuCores }}</td>
                    <td>{{ server.Gpu }}</td>
                    <td>{{ server.Memory }}GB</td>
                    <td>{{ server.Model }}</td>
                    <td>{{ location.BuildingNumber }}</td>
                    <td>{{ location.Room }}</td>
                    <td>{{ metric.Time }}</td>

                </tr>
                </tbody>
            </table>

        </div>
    </div>

    <div class="row mt-3 text-center"> {# Usage Table #}
        <span class="col-12 border border-dark ">
 <div class="col-12 ml-auto">

   <table class="table table-borderless table-hover">
       <tbody>
    <tr>
      <th scope="row"><h3><i class="fas fa-{{ color[server.ServerId]['CpuIcon'] }}"></i></h3></th>
        <td><h3 class="text-center">CPU Usage:</h3></td>
        <td><h3 class="text-danger"><a href="/usage-cpu/{{ server.ServerId }}"
                                       class="text-decoration-none text-{{ color[server.ServerId]['CpuColor'] }}">{{ metric.Cpu }}%</a></h3></td>
    </tr>
    <tr>
        <th scope="row"><h3><i class="fas fa-{{ color[server.ServerId]['RamIcon'] }}"></i></h3></th>
         <td><h3>RAM Usage:</h3></td>
        <td><h3 class="text-danger"><a href="/usage-RAM/{{ server.ServerId }}"
                                       class="text-decoration-none text-{{ color[server.ServerId]['RamColor'] }}">{{ metric.Ram }}%</a></h3></td>

    </tr>
    <tr>
        <th scope="row"><h3><i class="fas fa-{{ color[server.ServerId]['DiskIcon'] }}"></i></h3></th>
        <td><h3>Disk Usage:</h3></td>
        <td><h3 class="text-danger"><a href="/usage-Disk/{{ server.ServerId }}"
                                       class="text-decoration-none text-{{ color[server.ServerId]['DiskColor'] }}">{{ metric.Disk }}%</a></h3></td>
    </tr>
    <tr>
      <th scope="row"><h3><i class="fas fa-{{ color[server.ServerId]['GpuIcon'] }}"></i></h3></th>
      <td><h3>GPU Usage:</h3></td>
        <td><h3 class="text-danger"><a href="/usage-GPU/{{ server.ServerId }}"
                                       class="text-decoration-none text-{{ color[server.ServerId]['GpuColor'] }}">{{ metric.Gpu }}%</a></h3></td>
    </tr>
    <tr>
      <th scope="row"><h3><i class="fas fa-{{ color[server.ServerId]['PingIcon'] }}"></i></h3></th>
       <td><h3>Ping Status:</h3></td>
      <td><h3 class="text-success"><a href="/usage-Ping/{{ server.ServerId }}"
                                      class="text-decoration-none text-{{ color[server.ServerId]['PingColor'] }}">{{ metric.PingLatency }} ms - {{ color[server.ServerId]['PingStatus'] }} </a> </h3></td>

    </tr>
  </tbody>
    </table>

            </div>
        </span>

    </div>


    <div class="row mt-5 text-center"> {# Services Table #}
        <div class="col-lg-12 ml-auto">
        <button class="btn btn-light btn-lg btn-block" type="button" data-toggle="collapse" data-target="#collapseService" aria-expanded="false" aria-controls="collapseService">
            <div class="text-light p-2 h3" style="background-color: #40b3ff">Services</div></button>

            <div class="collapse" id="collapseService">
            <table id="service" class="display">
                <thead>
                <tr>
                    <th scope="col">Service ID</th>
                    <th scope="col">Service Name</th>
                    <th scope="col">Status</th>
                </tr>
                </thead>

                <tbody>

                {% for service in service %} {# Gets all services for this server #}
                    <tr>
                        <td scope="row">{{ service.ServiceId }}</td>
                        <td scope="row">{{ service.ServiceName }}</td>
                        <td>{{ service.Status }}</td>
                    </tr>
                {% endfor %}

                </tbody>
            </table></div>

        </div>
    </div>


    <div class="row mt-5 text-center"> {# Database Table #}
        <div class="col-lg-12 ml-auto">
            {% if database != 0 %}
                 <button class="btn btn-light btn-lg btn-block" type="button" data-toggle="collapse" data-target="#collapseDatabase" aria-expanded="false" aria-controls="collapseDatabase">
                     <div class="text-light p-2 h3" style="background-color: #40b3ff">Databases</div></button>
                <div class="collapse" id="collapseDatabase">
                <table id="database" class="display">
                    <thead>
                    <tr>
                        <th>Database ID</th>
                        <th>Database Name</th>
                        <th>Status</th>
                    </tr>
                    </thead>

                    <tbody>

                    {% for db in database %} {# Gets all databases for this server #}
                        <tr>
                            <th>{{ db.DatabaseId }}</th>
                            <th>{{ db.DatabaseName }}</th>
                            <td>{{ db.Status }}</td>
                        </tr>
                    {% endfor %}

                    </tbody>
                </table></div>
            {% endif %}
        </div>
    </div>
    <div class="row mt-5 text-center"> {# Running Job Table #}
        <div class="col-lg-12 ml-auto">
            {% if runningjob != 0 %}
                <button class="btn btn-light btn-lg btn-block" type="button" data-toggle="collapse" data-target="#collapseJobs" aria-expanded="false" aria-controls="collapseJobs">
                     <div class="text-light p-2 h3" style="background-color: #40b3ff">Running Jobs</div></button>
                <div class="collapse" id="collapseJobs">
                    <table id="jobs" class="display">
                    <thead>
                    <tr>
                        <th>Job Name</th>
                        <th>User</th>
                        <th>Remaining Time</th>
                    </tr>
                    </thead>

                    <tbody>

                    {% for rj in runningjob %} {# Gets all databases for this server #}
                        <tr>
                            <th>{{ rj.JobName }}</th>
                            <th>{{ rj.User }}</th>
                            <td>{{ rj.ReservedTime }}</td>
                        </tr>
                    {% endfor %}

                    </tbody>
                </table></div>
            {% endif %}
        </div>
    </div>

{% endblock content %}